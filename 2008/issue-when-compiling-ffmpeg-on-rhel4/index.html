<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Issue when compiling FFMPEG on RHEL4 · Scribbles & Bits</title><meta name="description" content="Issue when compiling FFMPEG on RHEL4 - Derek Gathright"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://derek.io/blog/atom.xml" title="Scribbles &amp; Bits"></head><body><div class="wrap"><header><a href="/blog/" class="logo-link"><img src="/blog/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/blog/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/derek" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/blog/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Issue when compiling FFMPEG on RHEL4</h1><div class="post-info">Jun 25, 2008</div><div class="post-content"><p>A user uploaded a Quicktime video to my website the other day and the server ran into a problem transcoding it to FLV.  I hit up #ffmpeg and it was suggested that I upgrade my install of FFMPEG and libfaad.  Alrighty, no big deal, done it before.  So first thing this morning was going to be update the sources and recompile.</p><br><p>Before I get on with that, first I’ll describe the environment.  We’re running on RHEL4 and have an install of FFMPEG that works fine (aside from that 1 user uploaded video).  The last upgrade of FFMPEG to get h264 support wasn’t done by me, but rather our sysadmin, when we actually had a sysadmin. I believe he used rpms for the libraries and compiled FFMPEG from the SVN repo.</p><br><p>So I did a quick search just to remind myself what libraries I needed and I came across <a href="http://pixels-and-politics.blogspot.com/2008/03/compile-ffmpeg-on-rhel4.html" target="_blank" rel="noopener">this post</a> about compiling on RHEL4, our distro. Perfect.  I followed directions to a T (aside from upgrading SVN) and it compiled fine.  Now, time to run a test transcode…</p><br>    <blockquote><br>        [root@140859-www1 ~]# /home/derek/ffmpeg_sources/ffmpeg/ffmpeg -y -i /media/v2-prod/atlas/8102/20206 -ab 64k -ar 22050 -b 700K -r 15 -y -s 640x480 -ac 1 -padtop -padbottom -s vga /home/derek/blah.flv<br>        FFmpeg version SVN-r13977, Copyright (c) 2000-2008 Fabrice Bellard, et al.<br>          configuration: –enable-libmp3lame –enable-libvorbis –enable-libfaac –enable-libfaad –enable-gpl –enable-libtheora –enable-libx264 –enable-shared<br>          libavutil version: 49.7.0<br>          libavcodec version: 51.57.2<br>          libavformat version: 52.16.0<br>          libavdevice version: 52.0.0<br>          built on Jun 25 2008 14:49:55, gcc: 3.4.6 20060404 (Red Hat 3.4.6-9)<br>        Input #0, mov,mp4,m4a,3gp,3g2,mj2, from ‘/media/v2-prod/atlas/8102/20206’:<br>          Duration: 00:10:55.2, start: 0.000000, bitrate: 406 kb/s<br>            Stream #0.0(und): Audio: mpeg4aac, 44100 Hz, stereo<br>            Stream #0.1(und): Video: h264, yuv420p, 320x240 [PAR 0:1 DAR 0:1], 30.00 tb(r)<br>        Output #0, flv, to ‘/home/derek/blah.flv’:<br>            Stream #0.0(und): Video: flv, yuv420p, 640x480 [PAR 0:1 DAR 0:1], q=2-31, 700 kb/s, 15.00 tb(c)<br>            Stream #0.1(und): Audio: libmp3lame, 22050 Hz, mono, 64 kb/s<br>        Stream mapping:<br>          Stream #0.1 -&gt; #0.0<br>          Stream #0.0 -&gt; #0.1<br>        Press [q] to stop encoding<br>        /home/derek/ffmpeg_sources/ffmpeg/ffmpeg: symbol lookup error: /home/derek/ffmpeg_sources/ffmpeg/ffmpeg: undefined symbol: av_fifo_generic_write<br>        You have new mail in /var/spool/mail/root<br>        </blockquote><br><p>Well shit.  Ok, so I hit up #ffmpeg again, but don’t get any help, so I try recompiling without any config options and it works fine.  So I slowly start added on config options and it works until I add “–enable-share”, and which point it compiles a version of FFMPEG that throws the “undefined symbol” error.  So that gives me a pretty good idea it has something to do with that.  I go through the symlinks in the guide (linked above) and notice that /usr/lib/libavformat.so.50 is symlinked to a file that doesn’t exist.  And that’s where I’m at now, kinda stumped.  Am I missing libraries?  how can I ensure any old libraries installed before are cleaned out and not conflicting with new ones?  I’m a developer, not a linux admin.  I know my way around the OS, but when it comes to this type of stuff, I’m stumped.</p><br><p>Any ideas? post a comment or email/gtalk me at drgath at gmail.com.</p>
</div></article></div></main><footer><div class="paginator"><a href="/blog/2008/tweenky-zendcon-vacations-ccckc-dotnext-etc-hellip/" class="prev">prev_post</a><a href="/blog/2008/reddit-fighting-with-its-developers/" class="next">next_post</a></div><div class="copyright"><p>© 2005 - 2018 <a href="http://derek.io/blog">Derek Gathright</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>