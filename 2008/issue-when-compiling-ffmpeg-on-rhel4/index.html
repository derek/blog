
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Issue When Compiling FFMPEG on RHEL4 - Scribbles and Bits</title>
  <meta name="author" content="Derek Gathright">

  
  <meta name="description" content="A user uploaded a Quicktime video to my website the other day and the server ran into a problem transcoding it to FLV. I hit up #ffmpeg and it was &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://derek.github.io/blog/2008/issue-when-compiling-ffmpeg-on-rhel4">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Scribbles and Bits" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Scribbles and Bits</a></h1>
  
    <h2>by Derek Gathright</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:derek.github.io/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Issue When Compiling FFMPEG on RHEL4</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-06-25T05:18:53-07:00" pubdate data-updated="true">Jun 25<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>A user uploaded a Quicktime video to my website the other day and the server ran into a problem transcoding it to FLV.  I hit up #ffmpeg and it was suggested that I upgrade my install of FFMPEG and libfaad.  Alrighty, no big deal, done it before.  So first thing this morning was going to be update the sources and recompile.</p>


<p>Before I get on with that, first I&#8217;ll describe the environment.  We&#8217;re running on RHEL4 and have an install of FFMPEG that works fine (aside from that 1 user uploaded video).  The last upgrade of FFMPEG to get h264 support wasn&#8217;t done by me, but rather our sysadmin, when we actually had a sysadmin. I believe he used rpms for the libraries and compiled FFMPEG from the SVN repo.</p>


<p>So I did a quick search just to remind myself what libraries I needed and I came across <a href="http://pixels-and-politics.blogspot.com/2008/03/compile-ffmpeg-on-rhel4.html">this post</a> about compiling on RHEL4, our distro. Perfect.  I followed directions to a T (aside from upgrading SVN) and it compiled fine.  Now, time to run a test transcode&#8230;</p>


<pre><code>&lt;blockquote&gt;
    [root@140859-www1 ~]# /home/derek/ffmpeg_sources/ffmpeg/ffmpeg -y -i /media/v2-prod/atlas/8102/20206 -ab 64k -ar 22050 -b 700K -r 15 -y -s 640x480 -ac 1 -padtop -padbottom -s vga /home/derek/blah.flv
    FFmpeg version SVN-r13977, Copyright (c) 2000-2008 Fabrice Bellard, et al.
      configuration: --enable-libmp3lame --enable-libvorbis --enable-libfaac --enable-libfaad --enable-gpl --enable-libtheora --enable-libx264 --enable-shared
      libavutil version: 49.7.0
      libavcodec version: 51.57.2
      libavformat version: 52.16.0
      libavdevice version: 52.0.0
      built on Jun 25 2008 14:49:55, gcc: 3.4.6 20060404 (Red Hat 3.4.6-9)
    Input #0, mov,mp4,m4a,3gp,3g2,mj2, from '/media/v2-prod/atlas/8102/20206':
      Duration: 00:10:55.2, start: 0.000000, bitrate: 406 kb/s
        Stream #0.0(und): Audio: mpeg4aac, 44100 Hz, stereo
        Stream #0.1(und): Video: h264, yuv420p, 320x240 [PAR 0:1 DAR 0:1], 30.00 tb(r)
    Output #0, flv, to '/home/derek/blah.flv':
        Stream #0.0(und): Video: flv, yuv420p, 640x480 [PAR 0:1 DAR 0:1], q=2-31, 700 kb/s, 15.00 tb(c)
        Stream #0.1(und): Audio: libmp3lame, 22050 Hz, mono, 64 kb/s
    Stream mapping:
      Stream #0.1 -&gt; #0.0
      Stream #0.0 -&gt; #0.1
    Press [q] to stop encoding
    /home/derek/ffmpeg_sources/ffmpeg/ffmpeg: symbol lookup error: /home/derek/ffmpeg_sources/ffmpeg/ffmpeg: undefined symbol: av_fifo_generic_write
    You have new mail in /var/spool/mail/root
    &lt;/blockquote&gt;
</code></pre>

<p>Well shit.  Ok, so I hit up #ffmpeg again, but don&#8217;t get any help, so I try recompiling without any config options and it works fine.  So I slowly start added on config options and it works until I add &#8220;&#8211;enable-share&#8221;, and which point it compiles a version of FFMPEG that throws the &#8220;undefined symbol&#8221; error.  So that gives me a pretty good idea it has something to do with that.  I go through the symlinks in the guide (linked above) and notice that /usr/lib/libavformat.so.50 is symlinked to a file that doesn&#8217;t exist.  And that&#8217;s where I&#8217;m at now, kinda stumped.  Am I missing libraries?  how can I ensure any old libraries installed before are cleaned out and not conflicting with new ones?  I&#8217;m a developer, not a linux admin.  I know my way around the OS, but when it comes to this type of stuff, I&#8217;m stumped.</p>


<p>Any ideas? post a comment or email/gtalk me at drgath at gmail.com.</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Derek</span></span>

      








  


<time datetime="2008-06-25T05:18:53-07:00" pubdate data-updated="true">Jun 25<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/blog/categories/web-development/'>Web Development</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://derek.github.io/blog/2008/issue-when-compiling-ffmpeg-on-rhel4/" data-via="" data-counturl="http://derek.github.io/blog/2008/issue-when-compiling-ffmpeg-on-rhel4/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/reddit-fighting-with-its-developers/" title="Previous Post: Reddit fighting with its developers">&laquo; Reddit fighting with its developers</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/tweenky-zendcon-vacations-ccckc-dotnext-etc/" title="Next Post: Tweenky, Zendcon, vacations, CCCKC, DotNext, etc&hellip;">Tweenky, Zendcon, vacations, CCCKC, DotNext, etc&hellip; &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/yui-benchmark/">YUI Benchmark</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/on-leaving-yahoo/">Leaving Yahoo</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/creating-an-api-service-with-yql/">Creating an API Service With YQL</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/learning-javascript/">Learning JavaScript</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/the-best-career-advice-youll-ever-get/">The Best Career Advice You'll Ever Get</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/splitt/">Splitt</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/planting-seeds/">Planting Seeds</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/joining-yui/">Joining YUI</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/the-engineer/">The Engineer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/google-translate/">Google Shutting Down the Translate API</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Derek Gathright -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
